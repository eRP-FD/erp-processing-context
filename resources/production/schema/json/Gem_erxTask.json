{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "$id": "Task",
  "oneOf": [
    {
      "$ref": "#/definitions/Task"
    }
  ],
  "definitions": {
    "Task": {
      "properties": {
        "resourceType": {
          "enum": [
            "Task"
          ]
        },
        "id": {
          "$ref": "BaseSchema.json#/definitions/id"
        },
        "meta": {
          "$ref": "BaseSchema.json#/definitions/Meta"
        },
        "implicitRules": {
          "$ref": "BaseSchema.json#/definitions/uri"
        },
        "_implicitRules": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "language": {
          "$ref": "BaseSchema.json#/definitions/code"
        },
        "_language": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "text": {
          "$ref": "BaseSchema.json#/definitions/Narrative"
        },
        "extension": {
          "type": "array",
          "minItems": 1,
          "maxItems": 3,
          "uniqueItems": true,
          "items": [
            {
              "$ref": "#/definitions/Extension_Flowtype"
            }
          ],
          "additionalItems": {
            "$ref": "#/definitions/Extension_Date"
          }
        },
        "modifierExtension": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Extension"
          },
          "type": "array"
        },
        "identifier": {
          "type": "array",
          "minItems": 1,
          "maxItems": 3,
          "uniqueItems": true,
          "items": [
            {
              "$ref": "Gem_erxPrescriptionID.json#/definitions/PrescriptionID"
            }
          ],
          "additionalItems": {
            "$ref": "#/definitions/Identifier_AccessCodeOrSecret"
          }
        },
        "instantiatesCanonical": {
          "$ref": "BaseSchema.json#/definitions/canonical"
        },
        "instantiatesUri": {
          "$ref": "BaseSchema.json#/definitions/uri"
        },
        "_instantiatesUri": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "basedOn": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Reference"
          },
          "type": "array"
        },
        "groupIdentifier": {
          "$ref": "BaseSchema.json#/definitions/Identifier"
        },
        "partOf": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Reference"
          },
          "type": "array"
        },
        "status": {
          "enum": [
            "draft",
            "ready",
            "cancelled",
            "in-progress",
            "completed"
          ]
        },
        "_status": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "statusReason": {
          "$ref": "BaseSchema.json#/definitions/CodeableConcept"
        },
        "businessStatus": {
          "$ref": "BaseSchema.json#/definitions/CodeableConcept"
        },
        "intent": {
          "enum": [
            "order"
          ]
        },
        "_intent": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "priority": {
          "$ref": "BaseSchema.json#/definitions/code"
        },
        "_priority": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "code": {
          "$ref": "BaseSchema.json#/definitions/CodeableConcept"
        },
        "description": {
          "$ref": "BaseSchema.json#/definitions/string"
        },
        "_description": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "focus": {
          "$ref": "BaseSchema.json#/definitions/Reference"
        },
        "for": {
          "$ref": "KVID.json#/definitions/KVID_Identifier"
        },
        "encounter": {
          "$ref": "BaseSchema.json#/definitions/Reference"
        },
        "executionPeriod": {
          "$ref": "BaseSchema.json#/definitions/Period"
        },
        "authoredOn": {
          "$ref": "BaseSchema.json#/definitions/dateTime"
        },
        "_authoredOn": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "lastModified": {
          "$ref": "BaseSchema.json#/definitions/dateTime"
        },
        "_lastModified": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "requester": {
          "$ref": "BaseSchema.json#/definitions/Reference"
        },
        "performerType": {
          "type": "array",
          "minItems": 1,
          "uniqueItems": true,
          "items": {
            "$ref": "#/definitions/CodeableConcept_PerformerType"
          }
        },
        "owner": {
          "$ref": "BaseSchema.json#/definitions/Reference"
        },
        "location": {
          "$ref": "BaseSchema.json#/definitions/Reference"
        },
        "reasonCode": {
          "$ref": "BaseSchema.json#/definitions/CodeableConcept"
        },
        "reasonReference": {
          "$ref": "BaseSchema.json#/definitions/Reference"
        },
        "insurance": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Reference"
          },
          "type": "array"
        },
        "note": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Annotation"
          },
          "type": "array"
        },
        "relevantHistory": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Reference"
          },
          "type": "array"
        },
        "restriction": {
          "$ref": "#/definitions/Task_Restriction"
        },
        "input": {
          "type": "array",
          "maxItems": 2,
          "uniqueItems": true,
          "items": {
            "$ref": "#/definitions/Task_Input"
          }
        },
        "output": {
          "type": "array",
          "maxItems": 1,
          "items": {
            "$ref": "#/definitions/Task_Output"
          }
        }
      },
      "additionalProperties": false,
      "required": [
        "authoredOn",
        "intent",
        "lastModified",
        "performerType",
        "resourceType",
        "status"
      ]
    },
    "Task_Restriction": {
      "properties": {
        "id": {
          "$ref": "BaseSchema.json#/definitions/string"
        },
        "extension": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Extension"
          },
          "type": "array"
        },
        "modifierExtension": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Extension"
          },
          "type": "array"
        },
        "repetitions": {
          "$ref": "BaseSchema.json#/definitions/positiveInt"
        },
        "_repetitions": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "period": {
          "$ref": "BaseSchema.json#/definitions/Period"
        },
        "recipient": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Reference"
          },
          "type": "array"
        }
      },
      "additionalProperties": false
    },
    "Task_Input": {
      "properties": {
        "id": {
          "$ref": "BaseSchema.json#/definitions/string"
        },
        "extension": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Extension"
          },
          "type": "array"
        },
        "modifierExtension": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Extension"
          },
          "type": "array"
        },
        "type": {
          "$ref": "#/definitions/Input_CodeableConcept"
        },
        "valueReference": {
          "$ref": "#/definitions/Task_Reference"
        }
      },
      "additionalProperties": false,
      "required": [
        "type",
        "valueReference"
      ]
    },
    "Task_Output": {
      "properties": {
        "id": {
          "$ref": "BaseSchema.json#/definitions/string"
        },
        "extension": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Extension"
          },
          "type": "array"
        },
        "modifierExtension": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Extension"
          },
          "type": "array"
        },
        "type": {
          "$ref": "#/definitions/Output_CodeableConcept"
        },
        "valueReference": {
          "$ref": "#/definitions/Task_Reference"
        }
      },
      "additionalProperties": false,
      "required": [
        "type",
        "valueReference"
      ]
    },
    "Extension_Flowtype": {
      "properties": {
        "id": {
          "$ref": "BaseSchema.json#/definitions/string"
        },
        "extension": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Extension"
          },
          "type": "array"
        },
        "url": {
          "type": "string",
          "enum": [
            "https://gematik.de/fhir/StructureDefinition/PrescriptionType"
          ]
        },
        "_url": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "valueCoding": {
          "$ref": "#/definitions/Coding_Flowtype"
        }
      },
      "required": [
        "url",
        "valueCoding"
      ],
      "additionalProperties": false
    },
    "Coding_Flowtype": {
      "properties": {
        "system": {
          "type": "string",
          "enum": [
            "https://gematik.de/fhir/CodeSystem/Flowtype"
          ]
        },
        "code": {
          "type": "string",
          "enum": [
            "160"
          ]
        },
        "display": {
          "type": "string",
          "enum": [
            "Muster 16 (Apothekenpflichtige Arzneimittel)"
          ]
        }
      },
      "required": [
        "system",
        "code",
        "display"
      ],
      "additionalProperties": false
    },
    "Extension_Date": {
      "properties": {
        "id": {
          "$ref": "BaseSchema.json#/definitions/string"
        },
        "extension": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Extension"
          },
          "type": "array"
        },
        "url": {
          "type": "string",
          "enum": [
            "https://gematik.de/fhir/StructureDefinition/AcceptDate",
            "https://gematik.de/fhir/StructureDefinition/ExpiryDate"
          ]
        },
        "_url": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "valueDate": {
          "pattern": "^([0-9]([0-9]([0-9][1-9]|[1-9]0)|[1-9]00)|[1-9]000)(-(0[1-9]|1[0-2])(-(0[1-9]|[1-2][0-9]|3[0-1]))?)?$",
          "type": "string"
        },
        "_valueDate": {
          "$ref": "BaseSchema.json#/definitions/Element"
        }
      },
      "required": [
        "url",
        "valueDate"
      ],
      "additionalProperties": false
    },
    "Identifier_AccessCodeOrSecret": {
      "properties": {
        "id": {
          "$ref": "BaseSchema.json#/definitions/string"
        },
        "extension": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Extension"
          },
          "type": "array"
        },
        "use": {
          "enum": [
            "usual",
            "official",
            "temp",
            "secondary",
            "old"
          ]
        },
        "_use": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "type": {
          "$ref": "BaseSchema.json#/definitions/CodeableConcept"
        },
        "_system": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "system": {
          "type": "string",
          "enum": [
            "https://gematik.de/fhir/NamingSystem/AccessCode",
            "https://gematik.de/fhir/NamingSystem/Secret"
          ]
        },
        "value": {
          "type": "string",
          "pattern": "^[A-Fa-f0-9]{64}$"
        },
        "_value": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "period": {
          "$ref": "BaseSchema.json#/definitions/Period"
        },
        "assigner": {
          "$ref": "BaseSchema.json#/definitions/Reference"
        }
      },
      "required": [
        "system",
        "value"
      ],
      "additionalProperties": false
    },
    "CodeableConcept_PerformerType": {
      "properties": {
        "id": {
          "$ref": "BaseSchema.json#/definitions/string"
        },
        "extension": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Extension"
          },
          "type": "array"
        },
        "coding": {
          "type": "array",
          "minItems": 1,
          "uniqueItems": true,
          "items": {
            "$ref": "#/definitions/Coding_PerformerType"
          }
        },
        "text": {
          "$ref": "BaseSchema.json#/definitions/string"
        },
        "_text": {
          "$ref": "BaseSchema.json#/definitions/Element"
        }
      },
      "additionalProperties": false,
      "required": [
        "coding"
      ]
    },
    "Coding_PerformerType": {
      "properties": {
        "id": {
          "$ref": "BaseSchema.json#/definitions/string"
        },
        "extension": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Extension"
          },
          "type": "array"
        },
        "system": {
          "enum": [
            "urn:ietf:rfc:3986"
          ]
        },
        "_system": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "version": {
          "$ref": "BaseSchema.json#/definitions/string"
        },
        "_version": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "code": {
          "enum": [
            "urn:oid:1.2.276.0.76.4.54"
          ]
        },
        "_code": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "display": {
          "enum": [
            "Öffentliche Apotheke"
          ]
        },
        "_display": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "userSelected": {
          "$ref": "BaseSchema.json#/definitions/boolean"
        },
        "_userSelected": {
          "$ref": "BaseSchema.json#/definitions/Element"
        }
      },
      "additionalProperties": false,
      "required": [
        "system",
        "code",
        "display"
      ]
    },
    "Input_CodeableConcept": {
      "properties": {
        "id": {
          "$ref": "BaseSchema.json#/definitions/string"
        },
        "extension": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Extension"
          },
          "type": "array"
        },
        "coding": {
          "type": "array",
          "minItems": 1,
          "maxItems": 1,
          "uniqueItems": true,
          "items": {
            "properties": {
              "id": {
                "$ref": "BaseSchema.json#/definitions/string"
              },
              "extension": {
                "items": {
                  "$ref": "BaseSchema.json#/definitions/Extension"
                },
                "type": "array"
              },
              "system": {
                "enum": [
                  "https://gematik.de/fhir/CodeSystem/Documenttype"
                ]
              },
              "_system": {
                "$ref": "BaseSchema.json#/definitions/Element"
              },
              "version": {
                "$ref": "BaseSchema.json#/definitions/string"
              },
              "_version": {
                "$ref": "BaseSchema.json#/definitions/Element"
              },
              "code": {
                "enum": [
                  "1",
                  "2"
                ]
              },
              "_code": {
                "$ref": "BaseSchema.json#/definitions/Element"
              },
              "display": {
                "type": "string"
              },
              "_display": {
                "$ref": "BaseSchema.json#/definitions/Element"
              },
              "userSelected": {
                "$ref": "BaseSchema.json#/definitions/boolean"
              },
              "_userSelected": {
                "$ref": "BaseSchema.json#/definitions/Element"
              }
            },
            "additionalProperties": false,
            "required": [
              "system",
              "code"
            ]
          }
        },
        "text": {
          "$ref": "BaseSchema.json#/definitions/string"
        },
        "_text": {
          "$ref": "BaseSchema.json#/definitions/Element"
        }
      },
      "additionalProperties": false,
      "required": [
        "coding"
      ]
    },
    "Task_Reference": {
      "properties": {
        "id": {
          "$ref": "BaseSchema.json#/definitions/string"
        },
        "extension": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Extension"
          },
          "type": "array"
        },
        "reference": {
          "$ref": "BaseSchema.json#/definitions/string"
        },
        "_reference": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "type": {
          "$ref": "BaseSchema.json#/definitions/uri"
        },
        "_type": {
          "$ref": "BaseSchema.json#/definitions/Element"
        },
        "identifier": {
          "$ref": "BaseSchema.json#/definitions/Identifier"
        },
        "display": {
          "$ref": "BaseSchema.json#/definitions/string"
        }
      },
      "additionalProperties": false,
      "required": [
        "reference"
      ]
    },
    "Output_CodeableConcept": {
      "properties": {
        "id": {
          "$ref": "BaseSchema.json#/definitions/string"
        },
        "extension": {
          "items": {
            "$ref": "BaseSchema.json#/definitions/Extension"
          },
          "type": "array"
        },
        "coding": {
          "type": "array",
          "minItems": 1,
          "maxItems": 1,
          "items": {
            "properties": {
              "id": {
                "$ref": "BaseSchema.json#/definitions/string"
              },
              "extension": {
                "items": {
                  "$ref": "BaseSchema.json#/definitions/Extension"
                },
                "type": "array"
              },
              "system": {
                "enum": [
                  "https://gematik.de/fhir/CodeSystem/Documenttype"
                ]
              },
              "_system": {
                "$ref": "BaseSchema.json#/definitions/Element"
              },
              "version": {
                "$ref": "BaseSchema.json#/definitions/string"
              },
              "_version": {
                "$ref": "BaseSchema.json#/definitions/Element"
              },
              "code": {
                "enum": [
                  "3"
                ]
              },
              "_code": {
                "$ref": "BaseSchema.json#/definitions/Element"
              },
              "display": {
                "type": "string"
              },
              "_display": {
                "$ref": "BaseSchema.json#/definitions/Element"
              },
              "userSelected": {
                "$ref": "BaseSchema.json#/definitions/boolean"
              },
              "_userSelected": {
                "$ref": "BaseSchema.json#/definitions/Element"
              }
            },
            "additionalProperties": false,
            "required": [
              "system",
              "code"
            ]
          }
        },
        "text": {
          "$ref": "BaseSchema.json#/definitions/string"
        },
        "_text": {
          "$ref": "BaseSchema.json#/definitions/Element"
        }
      },
      "additionalProperties": false,
      "required": [
        "coding"
      ]
    }
  }
}